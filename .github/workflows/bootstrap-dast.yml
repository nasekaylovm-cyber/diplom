name: DAST - OWASP ZAP

on:

  pull_request:
    branches: ["nasekaylovm-cyber-patch-1"]
  workflow_dispatch:

jobs:
 zap-scan:
    runs-on: ubuntu-latest
    
    if: github.event_name == 'push' && github.ref == 'refs/heads/master'
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: ZAP Full Scan
        uses: zaproxy/action-full-scan@v0.10.0
        with:
          target: 'http://5.129.250.92'
          rules_file_name: 'All'
          cmd_options: '-a'
          report_html: 'report.html'
          report_md: 'report.md'

      - name: Upload ZAP HTML report
        uses: actions/upload-artifact@v4
        if: always()
        with:
          name: zap-html-report
          path: report.html

      - name: Upload ZAP Markdown report
        uses: actions/upload-artifact@v4
        if: always()
        with:
          name: zap-md-report
          path: report.md
